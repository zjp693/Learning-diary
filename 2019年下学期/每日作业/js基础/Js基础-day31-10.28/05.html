<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>
        // 5、下面数组存储的为用户信息，根据要求编写程序

        // 1.用户登录
        // 程序运行开始，输入用户名和密码，
        //      用户名和密码输入正确，则进入程序主页
        //      用户名和密码输入错误，则弹出用户名密码错误，并重新输入用户名密码

        // 2.程序主页
        //         程序主页：
        //      尊敬的xx(管理员/普通用户) XX(用户名) 欢迎光临
        //   1.查看所有用户列表
        //   2.修改用户密码
        //   3.退出程序

        // 3.用户操作   
        //   用户输入 1,则将所有用户的信息展示出来
        //   用户输入 2,则需要判断用户是否为管理员
        //             如果为普通用户，则提示您没有权限修改密码
        // 如果为管理员，则提示
        // 请您输入需要修改的用户编号
        //     请您输入新的密码
        //                 用户操作完成后更新该用户编号的密码，并回到主页
        //   用户输入 3，则弹出输出“欢迎下次光临”，程序结束


        var users = [

            //用户编号 用户名 密码 权限

            {
                userId: "u01",
                userName: "曹操",
                upwd: 123,
                uadministor: "管理员"
            },

            {
                userId: "u02",
                userName: "许褚",
                upwd: 123,
                uadministor: "普通用户"
            },

            {
                userId: "u03",
                userName: "徐晃",
                upwd: 123,
                uadministor: "普通用户"
            },

            {
                userId: "u04",
                userName: "张辽",
                upwd: 123,
                uadministor: "普通用户"
            }

        ];


        //定义变量  判断是否进入程序主页
        var comeIndex = 0;

        //创建索引  保存登录成功时的索引
        var loginIndex = 0;


        while (true) {
            //用户输入 用户名 和 密码
            var username = prompt("请输入用户名");
            var password = Number(prompt("请输入密码"));

            //创建变量 flag
            var flag = false;


            //循环遍历数组对象
            for (let i = 0; i < users.length; i++) {

                //判断用户名  密码是否相等
                if (users[i].userName === username && users[i].upwd === password) {

                    loginIndex = i;

                    flag = true;

                    break;
                } else {
                    flag = false;
                }
            }

            //判断flag
            if (flag == true) {

                alert("登录成功  即将进入程序主页");
                //登录成功  进入程序主页
                comeIndex = 1;

                break;
            } else {

                alert("登录失败 用户名和密码错误  请重新输入用户名  和  密码");
                continue;
            }
            break;
        }


        while (true) {
            if (comeIndex == 1) {

                alert(`
            程序主页:
            尊敬的 ${users[loginIndex].uadministor}  ${users[loginIndex].userName}  欢迎光临`);

                //选择
                var num = Number(prompt(`
            请选择:
                1.查看所有用户列表
                2.修改用户密码
                3.退出程序
            `));


                switch (num) {
                    //展示信息
                    case 1:
                        //循环遍历数组对象
                        for (var i = 0; i < users.length; i++) {

                            var str = `
                        id : ${users[i].userId}
                        name : ${users[i].userName}
                        password : ${users[i].upwd}
                        admin : ${users[i].uadministor}
                        `;

                            alert(str);
                        }

                        continue;
                        //修改密码
                    case 2:
                        //判断用户是否为管理员
                        if (users[loginIndex].uadministor === "管理员") {

                            while (true) {

                                var id = prompt("请输入需要修改的用户编号");

                                var flag = false;

                                //定义索引  保存数组索引
                                var index = 0;

                                //定义变量  返回主页面
                                var b = 0;

                                //循环遍历数组对象
                                for (let i = 0; i < users.length; i++) {
                                    if (users[i].userId === id) {

                                        index = i;

                                        flag = true;
                                        break;
                                    } else {
                                        flag = false;
                                    }
                                }

                                //如果找到 数组对象
                                if (flag == true) {
                                    //修改密码
                                    var newPwd = prompt("请输入新的密码");

                                    users[index].upwd = newPwd;

                                    alert("修改成功");

                                    b = 1;

                                    break;
                                } else {
                                    //没找到 重新输入
                                    alert("没有该用户 请重新输入");
                                    continue;
                                }
                            }

                        } else {

                            alert("您没有权限修改密码");
                            continue;
                        }


                        //判断是否修改成功
                        if (b = 1) {

                            //修改成功返回主页面
                            continue;
                        }


                        break;

                        //程序结束
                    case 3:

                        alert("欢迎下次光临");

                        break;

                        //所输入数字超过范围
                    default:

                        alert("请输入范围内数字");

                        break;
                }
                break;
            }
        }
    </script>
</body>

</html>